# IP-less inteface, used to route public IPv4
# for Synnefo VMs
auto eth0.101
iface eth0.101 inet manual
    ip-routing-table rt_public
    ip-routes 62.217.123.128/27
    ip-gateway 62.217.123.129
    ip-forwarding 1
    ip-proxy-arp 1
    arp-ip 62.217.123.158

#auto eth0.100
iface eth0.100 inet manual
  up ip link set eth0.100 up

#auto br100
iface br100 inet static
  # needed for being the rooter for the VMs
  address 192.168.100.1
  netmask 255.255.255.240
  bridge_ports eth0.100
  # needed by nfdhcpd to make DHCP responses
  up ip route add 192.168.100.0/28 dev br100 table rt_net100
  up ip route add default via 192.168.100.1 dev br100 table rt_net100
  # needed for the VMs to connect to the world
  up iptables -t nat -A POSTROUTING -s 192.168.100.0/28 \! -d 192.168.100.0/28 -j MASQUERADE
  down iptables -t nat -D POSTROUTING -s 192.168.100.0/28 \! -d 192.168.100.0/28 -j MASQUERADE
  bridge_stp off
  bridge_fd 2

#auto br100:1
iface br100:1 inet static
  # needed for being the rooter for the VMs
  address 192.168.101.1
  netmask 255.255.255.240
  up ip route add 192.168.101.0/28 dev br100 table rt_net101
  up ip route add default via 192.168.101.1 dev br100 table rt_net101
  # needed for the VMs to connect to the world
  up iptables -t nat -A POSTROUTING -s 192.168.101.0/28 \! -d 192.168.101.0/28 -j MASQUERADE
  down iptables -t nat -D POSTROUTING -s 192.168.101.0/28 \! -d 192.168.101.0/28 -j MASQUERADE

